<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ãƒªãƒ†ãƒ©ã‚·ãƒ¼ã‚¯ã‚¤ã‚º - ãƒ¢ãƒƒã‚¯ï¼ˆå…¨éƒ¨å…¥ã‚Šï¼‰</title>
  <style>
  :root{
    --bg:#0f0f10;
    --board:#1e4b2a;
    --chalk:#f2f2f2;
    --wood:#b48a3a;
    --accent:#ffd46a;
    --danger:#ff6b6b;
    --ok:#6bffb0;

    /* è¿½åŠ ï¼šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåŸºæº– */
    --maxw:340px;      /* ä¸­èº«ã®æœ€å¤§å¹…ï¼ˆåŸºæº–ç·šï¼‰ */
    --padTop:28px;     /* headerä¸‹ã®ä½™ç™½ */
    --padBot:104px;    /* ä¸‹ãƒŠãƒ“+æœ¨æ åˆ†ã®ä½™ç™½ */
    --gap:16px;        /* è¦ç´ é–“éš” */
  }

  *{box-sizing:border-box;font-family:system-ui,-apple-system,"Noto Sans JP",sans-serif;}
  body{
    margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
    background:radial-gradient(1000px 600px at 50% 20%, #1b1b1d, var(--bg));
    color:var(--chalk);
    padding:14px;
  }

  /* phone frameï¼ˆå¤§ãã‚ï¼‰ */
  .phone{
    width:min(430px, 96vw);
    aspect-ratio:390/844;
    border:10px solid #2a2a2d;
    border-radius:28px;
    box-shadow:0 20px 60px rgba(0,0,0,.55);
    overflow:hidden;
    background:var(--board);
    position:relative;
  }

  .wood{position:absolute; inset:auto 0 0 0; height:52px; background:var(--wood);}
  .wood:before,.wood:after{
    content:""; position:absolute; bottom:10px; width:18px; height:18px;
    background:#8c6a2b; border-radius:3px;
  }
  .wood:before{left:50%; transform:translateX(-28px);}
  .wood:after {left:50%; transform:translateX(10px);}

  header{
    height:52px; display:flex; align-items:center; justify-content:center;
    font-weight:900; letter-spacing:.04em; opacity:.95;
    border-bottom:1px solid rgba(255,255,255,.10);
    position:relative;
  }
  header button{
    position:absolute; right:10px; top:10px;
    width:34px; height:34px; border-radius:10px;
    border:1px solid rgba(255,255,255,.2);
    background:rgba(0,0,0,.18); color:var(--chalk);
    cursor:pointer;
  }

  /* â˜…ã“ã“ãŒä¸€ç•ªåŠ¹ãï¼šå…¨ç”»é¢å…±é€šã®ä½™ç™½ã‚’èª¿æ•´ */
  main{ padding: var(--padTop) 18px var(--padBot); }

  /* ã‚¿ã‚¤ãƒˆãƒ«å‘¨ã‚Šã®è©°ã¾ã‚Šè§£æ¶ˆ */
  h1{ margin: 18px 0 22px; font-size:26px; text-align:center; }
  h2{ margin: 10px 0 18px; font-size:18px; text-align:center; opacity:.95; }

  .center{ display:flex; flex-direction:column; gap:var(--gap); align-items:center; }

  /* â˜…å¹…ã®åŸºæº–ç·šï¼šãƒœã‚¿ãƒ³/ã‚«ãƒ¼ãƒ‰/ãƒªã‚¹ãƒˆã‚’æƒãˆã‚‹ */
  .btn, .grid, .card, .list{
    width:88%;
    max-width:var(--maxw);
    margin-left:auto;
    margin-right:auto;
  }

  .btn{
    padding:14px 16px; border-radius:16px; cursor:pointer;
    border:1px solid rgba(255,255,255,.16);
    background:rgba(0,0,0,.16); color:var(--chalk);
    font-size:18px; font-weight:900;
  }
  .btn.primary{ border-color:rgba(255,212,106,.55); }
  .btn.small{ font-size:15px; font-weight:800; padding:12px 14px; border-radius:16px; }

  /* rowã®å¹…ã‚‚åŸºæº–ç·šã«åˆã‚ã›ã‚‹ */
  .row{ display:flex; gap:12px; width:88%; max-width:var(--maxw); margin:0 auto; }
  .row .btn{ width:50%; font-size:16px; font-weight:900; }

  /* ä¸‹ãƒŠãƒ“ï¼šåœ§è¿«ã‚’å°‘ã—å¼±ã‚ã‚‹ */
  .nav{
    position:absolute; left:0; right:0; bottom:52px;
    display:flex; justify-content:space-around; padding:10px 12px;
    border-top:1px solid rgba(255,255,255,.10);
    background:rgba(0,0,0,.10);
    backdrop-filter: blur(6px);
  }
  .nav button{
    background:none; border:none; color:var(--chalk);
    opacity:.9; font-weight:900; cursor:pointer;
    padding:6px 8px;
  }

  .card{
    border:1px solid rgba(255,255,255,.12);
    background:rgba(0,0,0,.12);
    border-radius:18px;
    padding:16px;
    line-height:1.85;
    font-size:15px;
    white-space:pre-wrap;
  }

  /* â˜…Quizã®ä¸¦ã³ã‚’å›ºå®šï¼šã‚«ãƒ¼ãƒ‰â†’â—¯Ã—â†’æ¡ˆå†… */
  .choice{ display:flex; gap:22px; justify-content:center; margin-top:24px; }
  .circle,.cross{
    width:80px; height:80px; border-radius:20px;
    display:grid; place-items:center; cursor:pointer;
    border:2px solid rgba(255,255,255,.30);
    background:rgba(0,0,0,.14);
    font-size:32px; font-weight:1000;
    user-select:none;
  }
  .circle{ border-color:rgba(255,212,106,.6); }

  .muted{ opacity:.82; font-weight:700; }

  .screen{ display:none; }
  .screen.active{ display:block; }

  .list{ display:flex; flex-direction:column; gap:10px; }
  .item{
    display:flex; justify-content:space-between; gap:10px;
    padding:12px 14px;
    border:1px solid rgba(255,255,255,.10);
    border-radius:16px; background:rgba(0,0,0,.10);
    font-size:14px;
  }

  .bigScore{ font-size:44px; font-weight:1000; text-align:center; margin:12px 0; }

  .pill{
    display:inline-block; padding:6px 10px; border-radius:999px;
    border:1px solid rgba(255,255,255,.14);
    background:rgba(0,0,0,.10);
    font-size:12px; font-weight:900; opacity:.95;
  }

  /* ã‚¸ãƒ£ãƒ³ãƒ«ãƒœã‚¿ãƒ³ */
  .grid{ display:grid; grid-template-columns:1fr; gap:10px; }
  .genreBtn{
    text-align:left;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }
  .genreLeft{ display:flex; gap:10px; align-items:center; } /* â˜…ã‚¢ã‚¤ã‚³ãƒ³ã¨æ–‡å­—ã‚’ç¸¦ä¸­å¤®ã« */
  .gIcon{
    width:34px; height:34px; border-radius:12px;
    display:grid; place-items:center;
    border:1px solid rgba(255,255,255,.16);
    background:rgba(0,0,0,.12);
    font-size:18px;
    flex:0 0 auto;
  }
  .genreName{ font-size:16px; font-weight:1000; }
  .genreDesc{ font-size:12px; opacity:.85; margin-top:3px; font-weight:700; }
  .rightArrow{ opacity:.9; font-weight:1000; }

  /* ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ */
  .judge{
    font-size:28px; font-weight:1000; text-align:center;
    margin:8px 0 12px;
  }
  .judge.ok{ color:var(--ok); }
  .judge.ng{ color:var(--danger); }
  .mini{
    font-size:12px; opacity:.85; font-weight:800; text-align:center;
    margin-top:12px;
  }
</style>

</head>
<body>
  <div class="phone" id="phone">
    <header>
      <span id="title">Home</span>
      <button id="homeBtn" title="Home" onclick="go('home')">âŒ‚</button>
    </header>

    <!-- HOME -->
    <section class="screen active" id="home">
      <main>
        <h1>ãƒªãƒ†ãƒ©ã‚·ãƒ¼ã‚¯ã‚¤ã‚º</h1>
        <div class="center">
          <button class="btn primary" onclick="go('genre')">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
          <div class="row">
            <button class="btn" onclick="go('history')">å±¥æ­´</button>
            <button class="btn" onclick="go('setting')">è¨­å®š</button>
          </div>
          <p class="muted">â€»ãƒ¢ãƒƒã‚¯ï¼šã‚¸ãƒ£ãƒ³ãƒ«â†’5å•â†’è§£èª¬â†’çµæœ</p>
        </div>
      </main>
      <div class="wood"></div>
    </section>

    <!-- GENRE SELECT -->
    <section class="screen" id="genre">
      <main>
        <h2>ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸æŠ</h2>
        <div class="grid" id="genreList"></div>
        <div class="center" style="margin-top:14px;">
          <button class="btn small" onclick="go('home')">æˆ»ã‚‹</button>
        </div>
      </main>
      <div class="wood"></div>
    </section>

    <!-- QUIZ -->
    <section class="screen" id="quiz">
      <main>
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:10px;">
          <span class="pill" id="genrePill">ã‚¸ãƒ£ãƒ³ãƒ«</span>
          <span class="pill" id="progressPill">1/5</span>
        </div>

        <div class="card" id="qText"></div>

        <div class="choice">
          <div class="circle" onclick="answer(true)">â—‹</div>
          <div class="cross" onclick="answer(false)">Ã—</div>
        </div>

        <p class="muted" style="text-align:center;margin-top:14px;">
          ã€Œæ­£ã—ã„ã¨æ€ã†æ–¹ã€ã‚’é¸ã¶
        </p>
      </main>
      <div class="wood"></div>
    </section>

    <!-- FEEDBACKï¼ˆæ¯å•ã®æ­£èª¤è§£èª¬ï¼‰ -->
    <section class="screen" id="feedback">
      <main>
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:10px;">
          <span class="pill" id="fbGenre">ã‚¸ãƒ£ãƒ³ãƒ«</span>
          <span class="pill" id="fbProgress">1/5</span>
        </div>

        <div class="judge" id="judgeText">æ­£è§£ï¼</div>

        <div class="card" id="expText"></div>

        <div class="center" style="margin-top:16px;">
          <button class="btn primary" id="nextBtn" onclick="nextFromFeedback()">æ¬¡ã¸</button>
          <button class="btn" onclick="go('home')">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
        </div>

        <div class="mini">â€»è§£èª¬ã¯ã€Œãªãœãã†åˆ¤æ–­ã™ã‚‹ã‹ã€ã‚’çŸ­ãã¾ã¨ã‚ã¦ã„ã¾ã™</div>
      </main>
      <div class="wood"></div>
    </section>

    <!-- RESULT -->
    <section class="screen" id="result">
      <main>
        <div class="bigScore" id="scoreLine">ã‚¹ã‚³ã‚¢ 0/5</div>
        <div class="card">
          <div>ã‚¸ãƒ£ãƒ³ãƒ«ï¼š<b id="resGenre">-</b></div>
          <div style="margin-top:10px;">æ­£è§£ï¼š<b id="ok">0</b></div>
          <div>ä¸æ­£è§£ï¼š<b id="ng">0</b></div>
        </div>
        <div class="center" style="margin-top:18px;">
          <button class="btn" onclick="go('home')">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
          <button class="btn" onclick="go('genre')">åˆ¥ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸ã¶</button>
          <button class="btn" onclick="restart()">åŒã˜ã‚¸ãƒ£ãƒ³ãƒ«ã§ã‚‚ã†ä¸€åº¦</button>
        </div>
      </main>
      <div class="wood"></div>
    </section>

    <!-- HISTORY -->
    <section class="screen" id="history">
      <main>
        <h1 style="font-size:22px;">å±¥æ­´</h1>
        <div class="list" id="histList"></div>
        <div class="center" style="margin-top:14px;">
          <button class="btn small" onclick="clearHist()">å±¥æ­´ã‚’æ¶ˆã™</button>
        </div>
        <p class="muted" style="margin-top:12px;">â€»ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰</p>
      </main>
      <div class="wood"></div>
    </section>

    <!-- SETTING -->
    <section class="screen" id="setting">
      <main>
        <h1 style="font-size:22px;">setting</h1>
        <div class="list">
          <div class="item"><span class="muted">BGM</span><span>100%</span></div>
          <div class="item"><span class="muted">SE</span><span>100%</span></div>
          <div class="item"><span class="muted">æ–‡å­—ã‚µã‚¤ã‚º</span><span>ä¸­</span></div>
          <div class="item"><span class="muted">ãƒ†ãƒ¼ãƒ</span><span>ãƒ€ãƒ¼ã‚¯</span></div>
        </div>
      </main>
      <div class="wood"></div>
    </section>

    <div class="nav">
      <button onclick="go('home')">Home</button>
      <button onclick="go('history')">å±¥æ­´</button>
      <button onclick="go('setting')">è¨­å®š</button>
    </div>
  </div>

<script>
  // 5ã‚¸ãƒ£ãƒ³ãƒ« Ã— å„5å•ï¼ˆtext/ans/expï¼‰
  const bank = {
    "ãƒ•ã‚§ã‚¤ã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹": [
      { text:"1) ã€å…¬å¼ãŒç™ºè¡¨ã€ã¨æ›¸ã„ã¦ã‚ã£ã¦ã‚‚ã€å‡ºå…¸ã‚„ç™ºä¿¡å…ƒã‚’ç¢ºèªã™ã‚‹ã®ãŒæœ›ã¾ã—ã„ã€‚", ans:true,
        exp:"ç†ç”±ï¼šã€å…¬å¼ã€ã¨ã„ã†è¨€è‘‰ã ã‘ã§ã¯æ ¹æ‹ ã«ãªã‚Šã¾ã›ã‚“ã€‚ç™ºä¿¡å…ƒï¼ˆå…¬å¼ã‚µã‚¤ãƒˆãƒ»å…¬å¼SNSãƒ»å ±é“æ©Ÿé–¢ï¼‰ã‚’ç¢ºèªã—ã¦è£å–ã‚Šã™ã‚‹ã®ãŒåŸºæœ¬ã§ã™ã€‚" },
      { text:"2) æ‹¡æ•£æ•°ãŒå¤šã„æŠ•ç¨¿ã»ã©æ­£ã—ã„å¯èƒ½æ€§ãŒé«˜ã„ã®ã§ã€ç¢ºèªã¯ä¸è¦ã ã€‚", ans:false,
        exp:"ç†ç”±ï¼šæ‹¡æ•£ã¯ã€æ­£ã—ã•ã€ã§ã¯ãªãã€æ„Ÿæƒ…ã‚’å‹•ã‹ã™å¼·ã•ã€ã§èµ·ãã‚„ã™ã„ã§ã™ã€‚æ ¹æ‹ ã‚„å‡ºå…¸ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚" },
      { text:"3) ç”»åƒä»˜ãã§ã‚‚ã€åˆ‡ã‚Šå–ã‚Šãƒ»åŠ å·¥ã®å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚æ³¨æ„ãŒå¿…è¦ã ã€‚", ans:true,
        exp:"ç†ç”±ï¼šç”»åƒã¯ç·¨é›†ã‚„æ–‡è„ˆã®åˆ‡ã‚Šå–ã‚ŠãŒã§ãã¾ã™ã€‚å…ƒç”»åƒãƒ»å…ƒè¨˜äº‹ãƒ»æ’®å½±æ—¥æ™‚ãªã©ã®ç¢ºèªãŒæœ‰åŠ¹ã§ã™ã€‚" },
      { text:"4) ã‚¿ã‚¤ãƒˆãƒ«ã ã‘ã§åˆ¤æ–­ã—ã¦ã‚‚ã€å†…å®¹ã¯ã ã„ãŸã„åŒã˜ãªã®ã§å•é¡Œãªã„ã€‚", ans:false,
        exp:"ç†ç”±ï¼šã‚¿ã‚¤ãƒˆãƒ«ã¯èª¤è§£ã‚’ç”Ÿã‚€è¡¨ç¾ã‚‚ã‚ã‚Šã¾ã™ã€‚æœ¬æ–‡ã®æ¡ä»¶ãƒ»æ•°å­—ãƒ»å‰æãŒé•ã†ã“ã¨ãŒå¤šã„ã§ã™ã€‚" },
      { text:"5) è¤‡æ•°ã®ä¿¡é ¼ã§ãã‚‹åª’ä½“ã§åŒã˜å†…å®¹ãŒç¢ºèªã§ãã‚‹ã¨ä¿¡é ¼æ€§ãŒä¸ŠãŒã‚‹ã€‚", ans:true,
        exp:"ç†ç”±ï¼šç‹¬è‡ªæƒ…å ±ã¯èª¤ã‚Šã‚‚ã‚ã‚Šãˆã¾ã™ã€‚è¤‡æ•°ã®ä¿¡é ¼ã§ãã‚‹æƒ…å ±æºã§ä¸€è‡´ã™ã‚‹ã¨ä¿¡é ¼æ€§ãŒé«˜ã¾ã‚Šã¾ã™ã€‚" },
    ],
    "SNSãƒãƒŠãƒ¼": [
      { text:"1) å‹é”ã®å†™çœŸã‚’è¼‰ã›ã‚‹å‰ã«ã€æœ¬äººã®åŒæ„ã‚’å–ã‚‹ã®ãŒæœ›ã¾ã—ã„ã€‚", ans:true,
        exp:"ç†ç”±ï¼šè‚–åƒæ¨©ãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã®å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚è¨±å¯ã‚’å–ã‚‹ã®ãŒå®‰å…¨ã§ãƒˆãƒ©ãƒ–ãƒ«ã‚‚é˜²ã’ã¾ã™ã€‚" },
      { text:"2) DMã®å†…å®¹ã¯å€‹äººé–“ã®ã‚‚ã®ãªã®ã§ã€ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦å…¬é–‹ã—ã¦ã‚‚å•é¡Œãªã„ã€‚", ans:false,
        exp:"ç†ç”±ï¼šDMã‚‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼æƒ…å ±ã§ã™ã€‚å…¬é–‹ã¯ä¿¡é ¼ã‚’å£Šã—ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚„åèª‰æ¯€æã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚" },
      { text:"3) å¼·ã„è¨€è‘‰ã§è¿”ä¿¡ã™ã‚‹å‰ã«ã€ä¸€åº¦è½ã¡ç€ã„ã¦è¦‹ç›´ã™ã®ãŒå®‰å…¨ã ã€‚", ans:true,
        exp:"ç†ç”±ï¼šæ„Ÿæƒ…çš„ãªæŠ•ç¨¿ã¯ç‚ä¸Šãƒ»èª¤è§£ã‚’æ‹›ãã‚„ã™ã„ã§ã™ã€‚æ™‚é–“ã‚’ç½®ã„ã¦è¦‹ç›´ã™ã®ãŒæœ‰åŠ¹ã§ã™ã€‚" },
      { text:"4) ç‚ä¸Šã—ã¦ã„ã‚‹è©±é¡Œã«ã¯ã€å†—è«‡ã§ã‚‚ä¾¿ä¹—ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã‚ˆã„ã€‚", ans:false,
        exp:"ç†ç”±ï¼šå†—è«‡ã§ã‚‚åˆ‡ã‚Šå–ã‚‰ã‚Œã¦æ‹¡æ•£ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚èª¤è§£ã•ã‚Œã‚„ã™ã„å ´ã§ã¯æ…é‡ãŒå¿…è¦ã§ã™ã€‚" },
      { text:"5) æŠ•ç¨¿ã¯å°†æ¥è¦‹ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€æ®‹ã‚‹å‰æã§æ›¸ãã¹ãã ã€‚", ans:true,
        exp:"ç†ç”±ï¼šã‚¹ã‚¯ã‚·ãƒ§ãƒ»è»¢è¼‰ãƒ»æ¤œç´¢ã§æ®‹ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã€å°†æ¥ã®è‡ªåˆ†ãŒè¦‹ã¦ã‚‚å¤§ä¸ˆå¤«ã‹ã€ã§åˆ¤æ–­ã—ã¾ã™ã€‚" },
    ],
    "ãƒãƒƒãƒˆè©æ¬º": [
      { text:"1) ã€è‡³æ€¥ã€ã€å½“é¸ã€ã€æœªæ‰•ã„ã€ãªã©ä¸å®‰ã‚’ç…½ã‚‹æ–‡é¢ã¯è©æ¬ºã®å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚", ans:true,
        exp:"ç†ç”±ï¼šç„¦ã‚‰ã›ã¦åˆ¤æ–­åŠ›ã‚’ä¸‹ã’ã‚‹ã®ã¯å…¸å‹çš„æ‰‹å£ã§ã™ã€‚ã¾ãšè½ã¡ç€ã„ã¦å…¬å¼çµŒè·¯ã§ç¢ºèªã—ã¾ã™ã€‚" },
      { text:"2) çŸ¥ã‚‰ãªã„ç•ªå·ã‹ã‚‰ã®SMSã§ã‚‚ã€ãƒªãƒ³ã‚¯å…ˆãŒãã‚Œã£ã½ã‘ã‚Œã°é–‹ã„ã¦ã‚ˆã„ã€‚", ans:false,
        exp:"ç†ç”±ï¼šå½ã‚µã‚¤ãƒˆã«èª˜å°ã•ã‚Œã‚‹å±é™ºãŒã‚ã‚Šã¾ã™ã€‚SMSã®ãƒªãƒ³ã‚¯ã¯é–‹ã‹ãšå…¬å¼ã‚µã‚¤ãƒˆ/å…¬å¼ã‚¢ãƒ—ãƒªã‹ã‚‰ç¢ºèªã—ã¾ã™ã€‚" },
      { text:"3) å…¬å¼ã‚’åä¹—ã‚‹ãƒ¡ãƒ¼ãƒ«ã§ã‚‚ã€é€ä¿¡å…ƒãƒ‰ãƒ¡ã‚¤ãƒ³ã‚„URLã‚’ç¢ºèªã™ã‚‹ã®ãŒå¤§åˆ‡ã€‚", ans:true,
        exp:"ç†ç”±ï¼šå·®å‡ºäººåã¯å½è£…ã§ãã¾ã™ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚„URLï¼ˆç¶´ã‚Šï¼‰ã‚’ç¢ºèªã—ã€æ€ªã—ã‘ã‚Œã°é–‹ã‹ãªã„ã®ãŒåŸºæœ¬ã§ã™ã€‚" },
      { text:"4) ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šã¯ã€ãƒ¡ãƒ¼ãƒ«ã®ãƒªãƒ³ã‚¯ã‹ã‚‰ç›´æ¥å…¥ã‚‹ã®ãŒæœ€ã‚‚å®‰å…¨ã ã€‚", ans:false,
        exp:"ç†ç”±ï¼šå½ãƒªãƒ³ã‚¯ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚„å…¬å¼ã‚¢ãƒ—ãƒªã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦å†è¨­å®šã™ã‚‹æ–¹ãŒå®‰å…¨ã§ã™ã€‚" },
      { text:"5) å°‘ã—ã§ã‚‚æ€ªã—ã„ã¨æ„Ÿã˜ãŸã‚‰ã€å…¬å¼ã‚µã‚¤ãƒˆ/å…¬å¼ã‚¢ãƒ—ãƒªã‹ã‚‰ç¢ºèªã™ã‚‹ã€‚", ans:true,
        exp:"ç†ç”±ï¼šæ€ªã—ã„é€£çµ¡ã¯ã€å…¬å¼çµŒè·¯ã§å†ç¢ºèªã€ãŒé‰„å‰‡ã§ã™ã€‚è¢«å®³ã®å¤šãã¯ãƒªãƒ³ã‚¯ã‚’è¸ã‚€ã“ã¨ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚" },
    ],
    "å€‹äººæƒ…å ±": [
      { text:"1) ä½æ‰€ãŒç‰¹å®šã•ã‚Œã‚‹æƒ…å ±ï¼ˆå­¦æ ¡åãƒ»æœ€å¯„ã‚Šãƒ»èƒŒæ™¯ã®çœ‹æ¿ãªã©ï¼‰ã«æ³¨æ„ã™ã‚‹ã€‚", ans:true,
        exp:"ç†ç”±ï¼šæ–­ç‰‡æƒ…å ±ã®çµ„ã¿åˆã‚ã›ã§ç‰¹å®šã•ã‚Œã¾ã™ã€‚èƒŒæ™¯ã‚„åˆ¶æœã€é€šå­¦ãƒ«ãƒ¼ãƒˆã®æ˜ ã‚Šè¾¼ã¿ã«ã‚‚æ³¨æ„ã—ã¾ã™ã€‚" },
      { text:"2) ä½ç½®æƒ…å ±ã®è‡ªå‹•ä»˜ä¸ã¯ä¾¿åˆ©ãªã®ã§ã€åŸºæœ¬ONã®ã¾ã¾ã§å•é¡Œãªã„ã€‚", ans:false,
        exp:"ç†ç”±ï¼šè‡ªå®…ã‚„è¡Œå‹•ç¯„å›²ãŒç‰¹å®šã•ã‚Œã‚‹å±é™ºãŒã‚ã‚Šã¾ã™ã€‚å¿…è¦ãªæ™‚ã ã‘ONã«ã™ã‚‹ã®ãŒå®‰å…¨ã§ã™ã€‚" },
      { text:"3) èª•ç”Ÿæ—¥ï¼‹é›»è©±ç•ªå·ãªã©ã¯ã€çµ„ã¿åˆã‚ã›ã‚‹ã¨æœ¬äººç‰¹å®šã«ç¹‹ãŒã‚Šã‚„ã™ã„ã€‚", ans:true,
        exp:"ç†ç”±ï¼šè¤‡æ•°ã®æƒ…å ±ãŒæƒã†ã¨æœ¬äººç¢ºèªã«ä½¿ã‚ã‚Œã‚„ã™ã„ã§ã™ã€‚å…¬é–‹ç¯„å›²ã‚„æŠ•ç¨¿å†…å®¹ã«æ³¨æ„ã—ã¾ã™ã€‚" },
      { text:"4) å…¬é–‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚‚ã€å‹é”ã ã‘ãŒè¦‹ã‚‹å‰æã§æŠ•ç¨¿ã—ã¦ã‚ˆã„ã€‚", ans:false,
        exp:"ç†ç”±ï¼šå…¬é–‹ï¼èª°ã§ã‚‚è¦‹ã‚‰ã‚Œã¾ã™ã€‚æ‹¡æ•£ãƒ»ä¿å­˜ã•ã‚Œã‚‹å‰æã§æŠ•ç¨¿ã™ã‚‹ã®ãŒå®‰å…¨ã§ã™ã€‚" },
      { text:"5) ã‚¢ãƒ—ãƒªã®æ¨©é™ï¼ˆä½ç½®æƒ…å ±/é€£çµ¡å…ˆãªã©ï¼‰ã¯å¿…è¦æœ€å°é™ã«ã™ã‚‹ã®ãŒå®‰å…¨ã€‚", ans:true,
        exp:"ç†ç”±ï¼šä¸è¦ãªæ¨©é™ã¯ãƒªã‚¹ã‚¯ã«ãªã‚Šã¾ã™ã€‚ç›®çš„ã«å¿…è¦ãªæ¨©é™ã ã‘è¨±å¯ã™ã‚‹ã®ãŒåŸºæœ¬ã§ã™ã€‚" },
    ],
    "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰": [
      { text:"1) åŒã˜ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä½¿ã„å›ã—ã¯ã€æµå‡ºæ™‚ã®è¢«å®³ãŒå¤§ãããªã‚‹ã€‚", ans:true,
        exp:"ç†ç”±ï¼š1ã¤æ¼ã‚Œã‚‹ã¨ä»–ã‚µãƒ¼ãƒ“ã‚¹ã‚‚é€£é–çš„ã«ä¾µå®³ã•ã‚Œã¾ã™ã€‚ã‚µãƒ¼ãƒ“ã‚¹ã”ã¨ã«åˆ¥ãƒ‘ã‚¹ãŒå®‰å…¨ã§ã™ã€‚" },
      { text:"2) èª•ç”Ÿæ—¥ã‚„åå‰ã¯è¦šãˆã‚„ã™ã„ã®ã§ã€å¼·ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ã—ã¦ååˆ†ã ã€‚", ans:false,
        exp:"ç†ç”±ï¼šæ¨æ¸¬ã•ã‚Œã‚„ã™ã„æƒ…å ±ã§ã™ã€‚é•·ãã¦ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ï¼ˆãƒ•ãƒ¬ãƒ¼ã‚ºå‹ã§ã‚‚OKï¼‰ãŒå¼·ã„ã§ã™ã€‚" },
      { text:"3) é•·ãã¦è¤‡é›‘ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã»ã©æ¨æ¸¬ã•ã‚Œã«ãã„ã€‚", ans:true,
        exp:"ç†ç”±ï¼šé•·ã•ã¯å¼·åº¦ã«ç›´çµã—ã¾ã™ã€‚å¯èƒ½ãªã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†ãƒ„ãƒ¼ãƒ«ï¼‹é•·ã„ãƒ‘ã‚¹ã§é‹ç”¨ã—ã¾ã™ã€‚" },
      { text:"4) ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å®šæœŸçš„ã«çŸ­ãå¤‰æ›´ã™ã‚‹ã¨å®‰å…¨æ€§ãŒä¸ŠãŒã‚‹ã€‚", ans:false,
        exp:"ç†ç”±ï¼šçŸ­ãã™ã‚‹ã¨å¼±ããªã‚Šã¾ã™ã€‚ã€æ¼ã‚ŒãŸå¯èƒ½æ€§ãŒã‚ã‚‹æ™‚ã«å¤‰æ›´ã€ï¼‹ã€é•·ãå¼·ãã€ãŒåŸºæœ¬ã§ã™ã€‚" },
      { text:"5) äºŒæ®µéšèªè¨¼ã‚’ä½¿ã†ã¨ã€ä¸æ­£ãƒ­ã‚°ã‚¤ãƒ³ã®ãƒªã‚¹ã‚¯ãŒä¸‹ãŒã‚‹ã€‚", ans:true,
        exp:"ç†ç”±ï¼šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ¼ã‚Œã¦ã‚‚è¿½åŠ èªè¨¼ã§æ­¢ã‚ã‚‰ã‚Œã¾ã™ã€‚å¯èƒ½ãªã‚µãƒ¼ãƒ“ã‚¹ã¯ONãŒæ¨å¥¨ã§ã™ã€‚" },
    ],
  };

  const meta = [
    { name:"ãƒ•ã‚§ã‚¤ã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹", icon:"ğŸ“°", desc:"å‡ºå…¸ãƒ»æ‹¡æ•£ãƒ»ç”»åƒã®è¦‹æ¥µã‚" },
    { name:"SNSãƒãƒŠãƒ¼",       icon:"ğŸ’¬", desc:"æŠ•ç¨¿ãƒ»è¿”ä¿¡ãƒ»åŒæ„ã®åŸºæœ¬" },
    { name:"ãƒãƒƒãƒˆè©æ¬º",       icon:"âš ï¸", desc:"SMS/ãƒ¡ãƒ¼ãƒ«/å½ã‚µã‚¤ãƒˆå¯¾ç­–" },
    { name:"å€‹äººæƒ…å ±",         icon:"ğŸ”’", desc:"ç‰¹å®šã•ã‚Œã‚‹æƒ…å ±ã¨æ¨©é™" },
    { name:"ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰",       icon:"ğŸ”‘", desc:"ä½¿ã„å›ã—ãƒ»å¼·åº¦ãƒ»äºŒæ®µéšèªè¨¼" },
  ];

  // çŠ¶æ…‹
  let currentGenre = null;
  let questions = [];
  let idx = 0, ok = 0, ng = 0;

  // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”¨
  let lastWasCorrect = false;
  let lastExp = "";
  let lastProgressText = "";

  // å±¥æ­´
  const HIST_KEY = "lit_hist_v3";
  function loadHist(){ return JSON.parse(localStorage.getItem(HIST_KEY) || "[]"); }
  function saveHist(list){ localStorage.setItem(HIST_KEY, JSON.stringify(list.slice(0, 30))); }

  // ç”»é¢é·ç§»
  function go(id){
    document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
    document.getElementById(id).classList.add("active");

    document.getElementById("title").textContent =
      id==="home" ? "Home" :
      id==="genre" ? "Genre" :
      id==="quiz" ? "Quiz" :
      id==="feedback" ? "Explain" :
      id==="result" ? "Result" :
      id==="history" ? "å±¥æ­´" : "è¨­å®š";

    if(id==="genre") renderGenres();
    if(id==="history") renderHist();
  }

  // ã‚¸ãƒ£ãƒ³ãƒ«ä¸€è¦§
  function renderGenres(){
    const el = document.getElementById("genreList");
    el.innerHTML = "";
    meta.forEach(m=>{
      const btn = document.createElement("button");
      btn.className = "btn small genreBtn";
      btn.onclick = () => startGenre(m.name);
      btn.innerHTML = `
        <div class="genreLeft">
          <div class="gIcon">${m.icon}</div>
          <div>
            <div class="genreName">${m.name}</div>
            <div class="genreDesc">${m.desc}</div>
          </div>
        </div>
        <div class="rightArrow">â–¶</div>
      `;
      el.appendChild(btn);
    });
  }

  // ã‚¸ãƒ£ãƒ³ãƒ«é–‹å§‹
  function startGenre(g){
    currentGenre = g;
    questions = bank[g].slice(0, 5);
    idx = 0; ok = 0; ng = 0;

    updateQuizUI();
    go("quiz");
  }

  function updateQuizUI(){
    document.getElementById("genrePill").textContent = currentGenre;
    document.getElementById("progressPill").textContent = `${idx+1}/${questions.length}`;
    document.getElementById("qText").textContent = questions[idx].text;
  }

  // å›ç­” â†’ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¸
  function answer(choice){
    const q = questions[idx];
    lastWasCorrect = (q.ans === choice);
    lastExp = q.exp;
    lastProgressText = `${idx+1}/${questions.length}`;

    if(lastWasCorrect) ok++; else ng++;

    // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¡¨ç¤º
    document.getElementById("fbGenre").textContent = currentGenre;
    document.getElementById("fbProgress").textContent = lastProgressText;

    const jt = document.getElementById("judgeText");
    jt.textContent = lastWasCorrect ? "æ­£è§£ï¼" : "ä¸æ­£è§£";
    jt.className = "judge " + (lastWasCorrect ? "ok" : "ng");

    document.getElementById("expText").textContent = lastExp;

    // æ¬¡ãƒœã‚¿ãƒ³æ–‡è¨€
    const isLast = (idx === questions.length - 1);
    document.getElementById("nextBtn").textContent = isLast ? "çµæœã¸" : "æ¬¡ã®å•é¡Œã¸";

    go("feedback");
  }

  // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‹ã‚‰æ¬¡ã¸
  function nextFromFeedback(){
    idx++;
    if(idx >= questions.length){
      // å±¥æ­´ä¿å­˜
      const list = loadHist();
      list.unshift({
        date: new Date().toLocaleString(),
        genre: currentGenre,
        ok,
        total: questions.length
      });
      saveHist(list);

      // çµæœè¡¨ç¤º
      document.getElementById("scoreLine").textContent = `ã‚¹ã‚³ã‚¢ ${ok}/${questions.length}`;
      document.getElementById("resGenre").textContent = currentGenre;
      document.getElementById("ok").textContent = ok;
      document.getElementById("ng").textContent = ng;

      go("result");
      return;
    }
    updateQuizUI();
    go("quiz");
  }

  function restart(){
    if(!currentGenre){ go("genre"); return; }
    startGenre(currentGenre);
  }

  // å±¥æ­´
  function renderHist(){
    const el = document.getElementById("histList");
    el.innerHTML = "";
    const list = loadHist();
    if(list.length === 0){
      el.innerHTML = `<div class="card">ã¾ã å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</div>`;
      return;
    }
    list.forEach(r=>{
      const div = document.createElement("div");
      div.className = "item";
      div.innerHTML = `<span>${r.date}ï¼ˆ${r.genre}ï¼‰</span><span>${r.ok}/${r.total}</span>`;
      el.appendChild(div);
    });
  }

  function clearHist(){
    localStorage.removeItem(HIST_KEY);
    renderHist();
  }

  // åˆæœŸ
  renderGenres();
</script>
</body>
</html>
